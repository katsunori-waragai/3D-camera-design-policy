# 3Dカメラ

以下のようにさまざまな３Dカメラがあるが、比較的簡単に置換え可能なことがのぞましい。

## カメラの種類
- Stereo Camera
- ToF Camera
- Structured light Camera
- monocular camera　(exceptional)

## camera hardware requirement
- 全ての時刻情報はCPUボード、各種センサボードで同期されていること
- 各種センサからの取得データには、時刻情報が付随していること。
- 画像センシングの結果には、必ず元となった画像データの取得時刻の情報を含んでいる
- データのスナップショットをとる操作と、そのデータを転送する操作とは区別されるべきである

#### あればなおうれしい項目
- 複数センサのデータのスナップショットを同期してとれれば、うれしい。
- 複数センサのデータの統合処理が楽になる。

---

# depth range and Field of View
3D カメラで計測可能なdepthと視野角とがある。

これは、３Dカメラを選んだときに決まる。
これによって、３Dカメラの候補のリストから自分たちの目的のためのカメラを選択する。

# camera connection
3D カメラは、ボードに接続するには、それぞれのインタフェースがある。

- USB
- MIPI(Camera Serial Interface)
- GMSL2
- その他多数

インタフェースによって、可能なケーブル長が異なる。
用途によっては、カメラの選択肢に影響する。


## 3D camera SDK
3Dカメラによっては、接続可能なCPUボードが予め制約されている。
そのOS用にカメラのデバイスドライバーが用意されている必要がある。
  自作カメラモジュールの場合には、そのデバイスドライバーを自身で開発する。
３Dカメラの場合、たいがい、OSと言語に対してSDKが用意されている。
そのSDKがあってはじめて、３Dカメラモジュールが標準で用意している深度・点群データが利用可能になる。
SDKとサンプル実装によっては、検出結果を３Dに表示して、追跡をするなどの例がある。
それらのSDKの充実度合いも、カメラを選択する際の考慮対象になる。

## digital twin
ロボットの動作を、シミュレーションによる強化学習を実施することが増えている。
それを実行するためには、シミュレーション空間上で、対象物の位置と姿勢を取得する必要がある。
単純な実装では、３D空間にある真値を利用するシミュレーションも存在する。
ただ実際の性能の予測には、センサ信号のシミュレーション、センサ信号にもとづく３D処理、画像認識処理を
実行するのがふつうである。
３D空間でのセンサ信号のシミュレーションを可能にするモジュールは、
３Dカメラメーカーによっては提供されている。


## カメラのノウハウ
- 偏光フィルタの有無
照明による反射の輝点は、ステレオ計測において問題となる。
偏光フィルタが利用可能なステレオカメラの場合、偏光フィルタ付きを選ぶのがよい。
- ToFカメラでの波長の選択
大気中の水蒸気による吸収がある波長域を用いているToFカメラを用いると、
屋外でも利用可能なToFカメラとなる。

## カメラ自体の特性
以下のような特性がRGBカメラ・グレースケールカメラでも重要になる。
- ハイダイナミックレンジ(HDR)
- 高感度・低ノイズ
- LEDフリッカー抑制

## selection by end user
ボードを自作しない範囲の人については、次の条件を満たすカメラを選択するとよい。

- timestampを扱ってくれるカメラ
- カメラにIMUがあって、画像に同期したタイミングでの姿勢データが得られること
- 落としてしまうなどの衝撃を加えても特性の変化が無視できること
- 使用する温度範囲の中で、深度を算出する特性への変化がないこと
  - もしくは、キャリブレーションによって簡単に対処できること
- 使用する製品の寿命において、 深度を算出する特性への変化がないこと
  - もしくは、キャリブレーションによって簡単に対処できること


## 参考情報
- [市販ＴoＦカメラについて調査中(2023年版）](https://qiita.com/nonbiri15/items/5fdb9962bbdc76274d90)
- [ステレオカメラ調査(2023年版）](https://qiita.com/nonbiri15/items/a8590a99941f8de4c8b8)
